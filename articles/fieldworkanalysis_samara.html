<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Endometriosis-associated Microbiome • Reviews of published signatures based on bugsigdb.org</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="The Endometriosis-associated Microbiome">
<meta property="og:description" content="bugSigSimple">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Reviews of published signatures based on bugsigdb.org</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/c-section_meconium_shaimaa.html">Delivery Mode and the Meconium Microbiome</a>
    </li>
    <li>
      <a href="../articles/capstoneanalysis_clare.html">COVID-19 associated microbiome</a>
    </li>
    <li>
      <a href="../articles/capstoneanalysis_fatima.html">An analysis of Most frequent taxa in Major Depression and Bipolar Disorder</a>
    </li>
    <li>
      <a href="../articles/capstoneanalysis_kweku.html">The Irritable Bowel Syndrome-associated Microbiome</a>
    </li>
    <li>
      <a href="../articles/fieldworkanalysis_samara.html">The Endometriosis-associated Microbiome</a>
    </li>
    <li>
      <a href="../articles/healthysig.html">Analysis of prevalent stool genera in bugsigdb.org</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/waldronlab/bugSigSimple" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="fieldworkanalysis_samara_files/kePrint-0.0.1/kePrint.js"></script><link href="fieldworkanalysis_samara_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>The Endometriosis-associated Microbiome</h1>
            
            <h4 data-toc-skip class="date">31 March, 2022</h4>
      
      
      <div class="hidden name"><code>fieldworkanalysis_samara.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="analysis-objectives">Analysis objectives<a class="anchor" aria-label="anchor" href="#analysis-objectives"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Import, recode, and subset data from bugsigdb.org<br>
</li>
<li>Create a table of studies</li>
<li>Calculate the frequency of appearance of each taxa in independent signatures and identify the most frequently reported taxa</li>
<li>Estimate the probability of the most frequently identified taxa occuring by chance</li>
</ol>
</div>
<div class="section level2">
<h2 id="making-sure-packages-are-installed">Making sure packages are installed<a class="anchor" aria-label="anchor" href="#making-sure-packages-are-installed"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"devtools"</span>, <span class="st">"tidyverse"</span>, <span class="st">"kableExtra"</span><span class="op">)</span><span class="op">)</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"waldronlab/bugSigSimple"</span><span class="op">)</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"waldronlab/BugSigDBStats"</span><span class="op">)</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"waldronlab/bugsigdbr"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="load-and-subset-data">Load and subset data<a class="anchor" aria-label="anchor" href="#load-and-subset-data"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://waldronlab.io/bugSigSimple" class="external-link">bugSigSimple</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/waldronlab/BugSigDBStats" class="external-link">BugSigDBStats</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/waldronlab/bugsigdbr" class="external-link">bugsigdbr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## ── <span style="font-weight: bold;">Attaching packages</span> ─────────────────────────────────────── tidyverse 1.3.1 ──</span></code></pre>
<pre><code><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">ggplot2</span> 3.3.5     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">purrr  </span> 0.3.4</span>
<span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tibble </span> 3.1.6     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dplyr  </span> 1.0.8</span>
<span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tidyr  </span> 1.2.0     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">stringr</span> 1.4.0</span>
<span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">readr  </span> 2.1.2     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">forcats</span> 0.5.1</span></code></pre>
<pre><code><span class="co">## ── <span style="font-weight: bold;">Conflicts</span> ────────────────────────────────────────── tidyverse_conflicts() ──</span>
<span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span> masks <span style="color: #0000BB;">stats</span>::filter()</span>
<span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>    masks <span style="color: #0000BB;">stats</span>::lag()</span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/" class="external-link">kableExtra</a></span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## Attaching package: 'kableExtra'</span></code></pre>
<pre><code><span class="co">## The following object is masked from 'package:dplyr':</span>
<span class="co">## </span>
<span class="co">##     group_rows</span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">bugsigdbr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bugsigdbr/man/importBugSigDB.html" class="external-link">importBugSigDB</a></span><span class="op">(</span>cache<span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Using cached version from 2022-03-31 12:38:44</span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 2098   48</span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##  [1] "Study"                      "Study design"              </span>
<span class="co">##  [3] "PMID"                       "DOI"                       </span>
<span class="co">##  [5] "URL"                        "Authors"                   </span>
<span class="co">##  [7] "Title"                      "Journal"                   </span>
<span class="co">##  [9] "Year"                       "Experiment"                </span>
<span class="co">## [11] "Location of subjects"       "Host species"              </span>
<span class="co">## [13] "Body site"                  "UBERON ID"                 </span>
<span class="co">## [15] "Condition"                  "EFO ID"                    </span>
<span class="co">## [17] "Group 0 name"               "Group 1 name"              </span>
<span class="co">## [19] "Group 1 definition"         "Group 0 sample size"       </span>
<span class="co">## [21] "Group 1 sample size"        "Antibiotics exclusion"     </span>
<span class="co">## [23] "Sequencing type"            "16S variable region"       </span>
<span class="co">## [25] "Sequencing platform"        "Statistical test"          </span>
<span class="co">## [27] "Significance threshold"     "MHT correction"            </span>
<span class="co">## [29] "LDA Score above"            "Matched on"                </span>
<span class="co">## [31] "Confounders controlled for" "Pielou"                    </span>
<span class="co">## [33] "Shannon"                    "Chao1"                     </span>
<span class="co">## [35] "Simpson"                    "Inverse Simpson"           </span>
<span class="co">## [37] "Richness"                   "Signature page name"       </span>
<span class="co">## [39] "Source"                     "Curated date"              </span>
<span class="co">## [41] "Curator"                    "Revision editor"           </span>
<span class="co">## [43] "Description"                "Abundance in Group 1"      </span>
<span class="co">## [45] "MetaPhlAn taxon names"      "NCBI Taxonomy IDs"         </span>
<span class="co">## [47] "State"                      "Reviewer"</span></code></pre>
</div>
<div class="section level2">
<h2 id="subsetting">Subsetting<a class="anchor" aria-label="anchor" href="#subsetting"></a>
</h2>
<p>Subsetting only studies done on humans - 6 of 17 studies were excluded because they were either done on mice or not statistically reliable (Cregger et. al)</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">subset.dat</span> <span class="op">&lt;-</span>
  <span class="va">dat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span>
    <span class="va">dat</span><span class="op">$</span><span class="va">PMID</span> <span class="op">==</span> <span class="st">"30778155"</span> <span class="op">|</span>
      <span class="va">dat</span><span class="op">$</span><span class="va">PMID</span> <span class="op">==</span> <span class="st">"32192080"</span> <span class="op">|</span>
      <span class="va">dat</span><span class="op">$</span><span class="va">PMID</span> <span class="op">==</span> <span class="st">"31087436"</span> <span class="op">|</span>
      <span class="va">dat</span><span class="op">$</span><span class="va">PMID</span> <span class="op">==</span> <span class="st">"26901400"</span> <span class="op">|</span>
      <span class="va">dat</span><span class="op">$</span><span class="va">PMID</span> <span class="op">==</span> <span class="st">"33839907"</span> <span class="op">|</span>
      <span class="va">dat</span><span class="op">$</span><span class="va">PMID</span> <span class="op">==</span> <span class="st">"32046455"</span> <span class="op">|</span>
      <span class="va">dat</span><span class="op">$</span><span class="va">PMID</span> <span class="op">==</span> <span class="st">"33925708"</span> <span class="op">|</span>
      <span class="va">dat</span><span class="op">$</span><span class="va">PMID</span> <span class="op">==</span> <span class="st">"32299442"</span> <span class="op">|</span>
      <span class="va">dat</span><span class="op">$</span><span class="va">PMID</span> <span class="op">==</span> <span class="st">"33313185"</span> <span class="op">|</span>
      <span class="va">dat</span><span class="op">$</span><span class="va">PMID</span> <span class="op">==</span> <span class="st">"34268384"</span> <span class="op">|</span> <span class="va">dat</span><span class="op">$</span><span class="va">PMID</span> <span class="op">==</span> <span class="st">"33660232"</span>
  <span class="op">)</span>, <span class="op">]</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="all-studies">All studies<a class="anchor" aria-label="anchor" href="#all-studies"></a>
</h2>
<p>Summary of studies and most frequent taxa increased and decreased in endometriosis patients for all studies</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">bugSigSimple</span><span class="fu">::</span><span class="fu"><a href="../reference/createStudyTable.html">createStudyTable</a></span><span class="op">(</span><span class="va">subset.dat</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 11 × 5</span></span>
<span class="co">##    Study          Condition     Cases Controls `Study Design`                   </span>
<span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                            </span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span> Akiyama 2019   endometriosis    30       39 cross-sectional observational, n…</span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span> Ata 2019       endometriosis    14       14 prospective cohort               </span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span> Chao 2021      endometriosis    37       66 case-control                     </span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span> Chen 2020      endometriosis    14       67 cross-sectional observational, n…</span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span> Hernandes 2020 endometriosis    10       11 case-control                     </span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span> Khan 2016      endometriosis    32       32 case-control                     </span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span> Lee 2021       endometriosis    45       45 case-control                     </span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span> Perrotta 2020  endometriosis    14       21 cross-sectional observational, n…</span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span> Shan 2021      endometriosis    12       12 case-control                     </span>
<span class="co">## <span style="color: #BCBCBC;">10</span> Svensson 2021  endometriosis    66      198 case-control                     </span>
<span class="co">## <span style="color: #BCBCBC;">11</span> Wei 2020       endometriosis    36       14 cross-sectional observational, n…</span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/getMostFrequentTaxa.html">getMostFrequentTaxa</a></span><span class="op">(</span><span class="va">subset.dat</span>,n<span class="op">=</span><span class="fl">30</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">##                                      k__Bacteria|p__Actinobacteria|c__Coriobacteriia|o__Coriobacteriales|f__Atopobiaceae|g__Atopobium </span>
<span class="co">##                                                                                                                                     7 </span>
<span class="co">##                                          k__Bacteria|p__Firmicutes|c__Bacilli|o__Lactobacillales|f__Streptococcaceae|g__Streptococcus </span>
<span class="co">##                                                                                                                                     5 </span>
<span class="co">##                                        k__Bacteria|p__Proteobacteria|c__Gammaproteobacteria|o__Enterobacterales|f__Enterobacteriaceae </span>
<span class="co">##                                                                                                                                     5 </span>
<span class="co">##                                              k__Bacteria|p__Actinobacteria|c__Coriobacteriia|o__Coriobacteriales|f__Coriobacteriaceae </span>
<span class="co">##                                                                                                                                     4 </span>
<span class="co">##                                                           k__Bacteria|p__Firmicutes|c__Bacilli|o__Lactobacillales|f__Streptococcaceae </span>
<span class="co">##                                                                                                                                     4 </span>
<span class="co">##                    k__Bacteria|p__Proteobacteria|c__Epsilonproteobacteria|o__Campylobacterales|f__Campylobacteraceae|g__Campylobacter </span>
<span class="co">##                                                                                                                                     4 </span>
<span class="co">##            k__Bacteria|p__Proteobacteria|c__Gammaproteobacteria|o__Enterobacterales|f__Enterobacteriaceae|s__Escherichia/Shigella sp. </span>
<span class="co">##                                                                                                                                     4 </span>
<span class="co">## k__Bacteria|p__Proteobacteria|c__Gammaproteobacteria|o__Pseudomonadales|f__Pseudomonadaceae|g__Pseudomonas|s__Pseudomonas viridiflava </span>
<span class="co">##                                                                                                                                     4 </span>
<span class="co">##                              k__Bacteria|p__Actinobacteria|c__Actinomycetia|o__Bifidobacteriales|f__Bifidobacteriaceae|g__Gardnerella </span>
<span class="co">##                                                                                                                                     3 </span>
<span class="co">##                   k__Bacteria|p__Firmicutes|c__Bacilli|o__Lactobacillales|f__Lactobacillaceae|g__Lactobacillus|s__Lactobacillus iners </span>
<span class="co">##                                                                                                                                     3 </span>
<span class="co">##                                             k__Bacteria|p__Firmicutes|c__Clostridia|o__Eubacteriales|f__Clostridiaceae|g__Clostridium </span>
<span class="co">##                                                                                                                                     3 </span>
<span class="co">##                                            k__Bacteria|p__Firmicutes|c__Clostridia|o__Eubacteriales|f__Lachnospiraceae|g__Lachnospira </span>
<span class="co">##                                                                                                                                     3 </span>
<span class="co">##                                           k__Bacteria|p__Proteobacteria|c__Gammaproteobacteria|o__Pseudomonadales|f__Pseudomonadaceae </span>
<span class="co">##                                                                                                                                     3 </span>
<span class="co">##                                                                                                         k__Bacteria|p__Actinobacteria </span>
<span class="co">##                                                                                                                                     2 </span>
<span class="co">##                                  k__Bacteria|p__Actinobacteria|c__Actinomycetia|o__Actinomycetales|f__Actinomycetaceae|g__Actinomyces </span>
<span class="co">##                                                                                                                                     2 </span>
<span class="co">##                                   k__Bacteria|p__Actinobacteria|c__Actinomycetia|o__Actinomycetales|f__Actinomycetaceae|g__Mobiluncus </span>
<span class="co">##                                                                                                                                     2 </span>
<span class="co">##                          k__Bacteria|p__Actinobacteria|c__Actinomycetia|o__Bifidobacteriales|f__Bifidobacteriaceae|g__Bifidobacterium </span>
<span class="co">##                                                                                                                                     2 </span>
<span class="co">##                                                     k__Bacteria|p__Actinobacteria|c__Actinomycetia|o__Micrococcales|f__Micrococcaceae </span>
<span class="co">##                                                                                                                                     2 </span>
<span class="co">##                                                                          k__Bacteria|p__Bacteroidetes|c__Bacteroidia|o__Bacteroidales </span>
<span class="co">##                                                                                                                                     2 </span>
<span class="co">##                                          k__Bacteria|p__Bacteroidetes|c__Bacteroidia|o__Bacteroidales|f__Prevotellaceae|g__Prevotella </span>
<span class="co">##                                                                                                                                     2 </span>
<span class="co">##                                                               k__Bacteria|p__Firmicutes|c__Bacilli|o__Bacillales|f__Staphylococcaceae </span>
<span class="co">##                                                                                                                                     2 </span>
<span class="co">##                                                                         k__Bacteria|p__Firmicutes|c__Bacilli|o__Bacillales|g__Gemella </span>
<span class="co">##                                                                                                                                     2 </span>
<span class="co">##                                                k__Bacteria|p__Firmicutes|c__Bacilli|o__Lactobacillales|f__Aerococcaceae|g__Aerococcus </span>
<span class="co">##                                                                                                                                     2 </span>
<span class="co">##                                            k__Bacteria|p__Firmicutes|c__Bacilli|o__Lactobacillales|f__Enterococcaceae|g__Enterococcus </span>
<span class="co">##                                                                                                                                     2 </span>
<span class="co">##                                                           k__Bacteria|p__Firmicutes|c__Bacilli|o__Lactobacillales|f__Lactobacillaceae </span>
<span class="co">##                                                                                                                                     2 </span>
<span class="co">##                                          k__Bacteria|p__Firmicutes|c__Bacilli|o__Lactobacillales|f__Lactobacillaceae|g__Lactobacillus </span>
<span class="co">##                                                                                                                                     2 </span>
<span class="co">##            k__Bacteria|p__Firmicutes|c__Clostridia|o__Eubacteriales|f__Lachnospiraceae|g__Mediterraneibacter|s__[Ruminococcus] gnavus </span>
<span class="co">##                                                                                                                                     2 </span>
<span class="co">##                                      k__Bacteria|p__Firmicutes|c__Clostridia|o__Eubacteriales|f__Oscillospiraceae|g__Faecalibacterium </span>
<span class="co">##                                                                                                                                     2 </span>
<span class="co">##                                          k__Bacteria|p__Firmicutes|c__Clostridia|o__Eubacteriales|f__Oscillospiraceae|g__Oscillospira </span>
<span class="co">##                                                                                                                                     2 </span>
<span class="co">##                                     k__Bacteria|p__Firmicutes|c__Clostridia|o__Eubacteriales|f__Oscillospiraceae|g__Ruminiclostridium </span>
<span class="co">##                                                                                                                                     2</span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/getMostFrequentTaxa.html">getMostFrequentTaxa</a></span><span class="op">(</span><span class="va">subset.dat</span>,sig.type<span class="op">=</span><span class="st">"increased"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">##                                          k__Bacteria|p__Firmicutes|c__Bacilli|o__Lactobacillales|f__Streptococcaceae|g__Streptococcus </span>
<span class="co">##                                                                                                                                     5 </span>
<span class="co">##                                        k__Bacteria|p__Proteobacteria|c__Gammaproteobacteria|o__Enterobacterales|f__Enterobacteriaceae </span>
<span class="co">##                                                                                                                                     5 </span>
<span class="co">##                                                           k__Bacteria|p__Firmicutes|c__Bacilli|o__Lactobacillales|f__Streptococcaceae </span>
<span class="co">##                                                                                                                                     4 </span>
<span class="co">##            k__Bacteria|p__Proteobacteria|c__Gammaproteobacteria|o__Enterobacterales|f__Enterobacteriaceae|s__Escherichia/Shigella sp. </span>
<span class="co">##                                                                                                                                     4 </span>
<span class="co">##                                              k__Bacteria|p__Actinobacteria|c__Coriobacteriia|o__Coriobacteriales|f__Coriobacteriaceae </span>
<span class="co">##                                                                                                                                     3 </span>
<span class="co">##                                             k__Bacteria|p__Firmicutes|c__Clostridia|o__Eubacteriales|f__Clostridiaceae|g__Clostridium </span>
<span class="co">##                                                                                                                                     3 </span>
<span class="co">##                                           k__Bacteria|p__Proteobacteria|c__Gammaproteobacteria|o__Pseudomonadales|f__Pseudomonadaceae </span>
<span class="co">##                                                                                                                                     3 </span>
<span class="co">## k__Bacteria|p__Proteobacteria|c__Gammaproteobacteria|o__Pseudomonadales|f__Pseudomonadaceae|g__Pseudomonas|s__Pseudomonas viridiflava </span>
<span class="co">##                                                                                                                                     3 </span>
<span class="co">##                          k__Bacteria|p__Actinobacteria|c__Actinomycetia|o__Bifidobacteriales|f__Bifidobacteriaceae|g__Bifidobacterium </span>
<span class="co">##                                                                                                                                     2 </span>
<span class="co">##                              k__Bacteria|p__Actinobacteria|c__Actinomycetia|o__Bifidobacteriales|f__Bifidobacteriaceae|g__Gardnerella </span>
<span class="co">##                                                                                                                                     2</span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/getMostFrequentTaxa.html">getMostFrequentTaxa</a></span><span class="op">(</span><span class="va">subset.dat</span>,sig.type<span class="op">=</span><span class="st">"decreased"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">##                    k__Bacteria|p__Actinobacteria|c__Coriobacteriia|o__Coriobacteriales|f__Atopobiaceae|g__Atopobium </span>
<span class="co">##                                                                                                                   5 </span>
<span class="co">##                 k__Bacteria|p__Actinobacteria|c__Actinomycetia|o__Actinomycetales|f__Actinomycetaceae|g__Mobiluncus </span>
<span class="co">##                                                                                                                   2 </span>
<span class="co">##                                                        k__Bacteria|p__Bacteroidetes|c__Bacteroidia|o__Bacteroidales </span>
<span class="co">##                                                                                                                   2 </span>
<span class="co">##                        k__Bacteria|p__Bacteroidetes|c__Bacteroidia|o__Bacteroidales|f__Prevotellaceae|g__Prevotella </span>
<span class="co">##                                                                                                                   2 </span>
<span class="co">## k__Bacteria|p__Firmicutes|c__Bacilli|o__Lactobacillales|f__Lactobacillaceae|g__Lactobacillus|s__Lactobacillus iners </span>
<span class="co">##                                                                                                                   2 </span>
<span class="co">##                          k__Bacteria|p__Firmicutes|c__Clostridia|o__Eubacteriales|f__Lachnospiraceae|g__Lachnospira </span>
<span class="co">##                                                                                                                   2 </span>
<span class="co">##                      k__Bacteria|p__Firmicutes|c__Negativicutes|o__Veillonellales|f__Veillonellaceae|g__Megasphaera </span>
<span class="co">##                                                                                                                   2 </span>
<span class="co">##                     k__Bacteria|p__Fusobacteria|c__Fusobacteriia|o__Fusobacteriales|f__Leptotrichiaceae|g__Sneathia </span>
<span class="co">##                                                                                                                   2 </span>
<span class="co">##  k__Bacteria|p__Proteobacteria|c__Epsilonproteobacteria|o__Campylobacterales|f__Campylobacteraceae|g__Campylobacter </span>
<span class="co">##                                                                                                                   2 </span>
<span class="co">##                                                                                       k__Bacteria|p__Actinobacteria </span>
<span class="co">##                                                                                                                   1</span></code></pre>
</div>
<div class="section level2">
<h2 id="excluding-feces-samples">Excluding feces samples<a class="anchor" aria-label="anchor" href="#excluding-feces-samples"></a>
</h2>
<p>Summary of studies and most frequent taxa in only samples from female reproductive tract, excluding feces samples</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">subset.dat2</span> <span class="op">&lt;-</span>
  <span class="va">dat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span>
    <span class="va">dat</span><span class="op">$</span><span class="va">PMID</span> <span class="op">==</span> <span class="st">"30778155"</span> <span class="op">|</span>
      <span class="va">dat</span><span class="op">$</span><span class="va">PMID</span> <span class="op">==</span> <span class="st">"32192080"</span> <span class="op">|</span>
      <span class="va">dat</span><span class="op">$</span><span class="va">PMID</span> <span class="op">==</span> <span class="st">"31087436"</span> <span class="op">|</span>
      <span class="va">dat</span><span class="op">$</span><span class="va">PMID</span> <span class="op">==</span> <span class="st">"26901400"</span> <span class="op">|</span>
      <span class="va">dat</span><span class="op">$</span><span class="va">PMID</span> <span class="op">==</span> <span class="st">"32046455"</span> <span class="op">|</span>
      <span class="va">dat</span><span class="op">$</span><span class="va">PMID</span> <span class="op">==</span> <span class="st">"33925708"</span> <span class="op">|</span>
      <span class="va">dat</span><span class="op">$</span><span class="va">PMID</span> <span class="op">==</span> <span class="st">"32299442"</span> <span class="op">|</span>
      <span class="va">dat</span><span class="op">$</span><span class="va">PMID</span> <span class="op">==</span> <span class="st">"33313185"</span> <span class="op">|</span> <span class="va">dat</span><span class="op">$</span><span class="va">PMID</span> <span class="op">==</span> <span class="st">"34268384"</span>
  <span class="op">)</span>, <span class="op">]</span>

<span class="va">reproductive_sigs</span> <span class="op">&lt;-</span>
  <span class="va">subset.dat2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">subset.dat2</span><span class="op">$</span><span class="va">`Body site`</span> <span class="op">!=</span> <span class="st">"feces"</span> <span class="op">|</span>
                      <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">subset.dat2</span><span class="op">$</span><span class="va">`Body site`</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span>

<span class="fu">bugSigSimple</span><span class="fu">::</span><span class="fu"><a href="../reference/createStudyTable.html">createStudyTable</a></span><span class="op">(</span><span class="va">reproductive_sigs</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 9 × 5</span></span>
<span class="co">##   Study          Condition     Cases Controls `Study Design`                    </span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                             </span>
<span class="co">## <span style="color: #BCBCBC;">1</span> Akiyama 2019   endometriosis    30       39 cross-sectional observational, no…</span>
<span class="co">## <span style="color: #BCBCBC;">2</span> Ata 2019       endometriosis    14       14 prospective cohort                </span>
<span class="co">## <span style="color: #BCBCBC;">3</span> Chao 2021      endometriosis    37       66 case-control                      </span>
<span class="co">## <span style="color: #BCBCBC;">4</span> Chen 2020      endometriosis    14       67 cross-sectional observational, no…</span>
<span class="co">## <span style="color: #BCBCBC;">5</span> Hernandes 2020 endometriosis    10       11 case-control                      </span>
<span class="co">## <span style="color: #BCBCBC;">6</span> Khan 2016      endometriosis    32       32 case-control                      </span>
<span class="co">## <span style="color: #BCBCBC;">7</span> Lee 2021       endometriosis    45       45 case-control                      </span>
<span class="co">## <span style="color: #BCBCBC;">8</span> Perrotta 2020  endometriosis    14       21 cross-sectional observational, no…</span>
<span class="co">## <span style="color: #BCBCBC;">9</span> Wei 2020       endometriosis    36       14 cross-sectional observational, no…</span></code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">allfreqs</span> <span class="op">&lt;-</span> <span class="fu">bugSigSimple</span><span class="fu">::</span><span class="fu"><a href="../reference/createTaxonTable.html">createTaxonTable</a></span><span class="op">(</span><span class="va">reproductive_sigs</span>, n <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co">#could change number</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">decreased_signatures</span> <span class="op">-</span> <span class="va">increased_signatures</span><span class="op">)</span><span class="op">)</span>
<span class="va">incfreqs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">allfreqs</span>, <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">increased_signatures</span> <span class="op">-</span> <span class="va">decreased_signatures</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">decfreqs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">allfreqs</span>, <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">increased_signatures</span> <span class="op">-</span> <span class="va">decreased_signatures</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span>
<span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html" class="external-link">kbl</a></span><span class="op">(</span><span class="va">allfreqs</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_classic.html" class="external-link">kable_paper</a></span><span class="op">(</span><span class="st">"hover"</span>, full_width <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<table class="table  lightable-paper lightable-hover" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>
<thead><tr>
<th style="text-align:left;">
Taxon Name
</th>
<th style="text-align:left;">
Taxonomic Level
</th>
<th style="text-align:right;">
total_signatures
</th>
<th style="text-align:right;">
increased_signatures
</th>
<th style="text-align:right;">
decreased_signatures
</th>
<th style="text-align:right;">
Binomial Test pval
</th>
<th style="text-align:left;">
kingdom
</th>
<th style="text-align:left;">
phylum
</th>
<th style="text-align:left;">
class
</th>
<th style="text-align:left;">
order
</th>
<th style="text-align:left;">
family
</th>
<th style="text-align:left;">
genus
</th>
<th style="text-align:left;">
species
</th>
<th style="text-align:right;">
n_signatures
</th>
<th style="text-align:left;">
metaphlan_name
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Streptococcus
</td>
<td style="text-align:left;">
genus
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:left;">
Bacteria
</td>
<td style="text-align:left;">
Firmicutes
</td>
<td style="text-align:left;">
Bacilli
</td>
<td style="text-align:left;">
Lactobacillales
</td>
<td style="text-align:left;">
Streptococcaceae
</td>
<td style="text-align:left;">
Streptococcus
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
k__Bacteria|p__Firmicutes|c__Bacilli|o__Lactobacillales|f__Streptococcaceae|g__Streptococcus
</td>
</tr>
<tr>
<td style="text-align:left;">
Escherichia/Shigella sp.
</td>
<td style="text-align:left;">
species
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:left;">
Bacteria
</td>
<td style="text-align:left;">
Proteobacteria
</td>
<td style="text-align:left;">
Gammaproteobacteria
</td>
<td style="text-align:left;">
Enterobacterales
</td>
<td style="text-align:left;">
Enterobacteriaceae
</td>
<td style="text-align:left;">
Escherichia/Shigella sp.
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
k__Bacteria|p__Proteobacteria|c__Gammaproteobacteria|o__Enterobacterales|f__Enterobacteriaceae|s__Escherichia/Shigella sp.
</td>
</tr>
<tr>
<td style="text-align:left;">
Coriobacteriaceae
</td>
<td style="text-align:left;">
family
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:left;">
Bacteria
</td>
<td style="text-align:left;">
Actinobacteria
</td>
<td style="text-align:left;">
Coriobacteriia
</td>
<td style="text-align:left;">
Coriobacteriales
</td>
<td style="text-align:left;">
Coriobacteriaceae
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
k__Bacteria|p__Actinobacteria|c__Coriobacteriia|o__Coriobacteriales|f__Coriobacteriaceae
</td>
</tr>
<tr>
<td style="text-align:left;">
Streptococcaceae
</td>
<td style="text-align:left;">
family
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:left;">
Bacteria
</td>
<td style="text-align:left;">
Firmicutes
</td>
<td style="text-align:left;">
Bacilli
</td>
<td style="text-align:left;">
Lactobacillales
</td>
<td style="text-align:left;">
Streptococcaceae
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
k__Bacteria|p__Firmicutes|c__Bacilli|o__Lactobacillales|f__Streptococcaceae
</td>
</tr>
<tr>
<td style="text-align:left;">
Enterobacteriaceae
</td>
<td style="text-align:left;">
family
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:left;">
Bacteria
</td>
<td style="text-align:left;">
Proteobacteria
</td>
<td style="text-align:left;">
Gammaproteobacteria
</td>
<td style="text-align:left;">
Enterobacterales
</td>
<td style="text-align:left;">
Enterobacteriaceae
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
k__Bacteria|p__Proteobacteria|c__Gammaproteobacteria|o__Enterobacterales|f__Enterobacteriaceae
</td>
</tr>
<tr>
<td style="text-align:left;">
Pseudomonadaceae
</td>
<td style="text-align:left;">
family
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:left;">
Bacteria
</td>
<td style="text-align:left;">
Proteobacteria
</td>
<td style="text-align:left;">
Gammaproteobacteria
</td>
<td style="text-align:left;">
Pseudomonadales
</td>
<td style="text-align:left;">
Pseudomonadaceae
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
k__Bacteria|p__Proteobacteria|c__Gammaproteobacteria|o__Pseudomonadales|f__Pseudomonadaceae
</td>
</tr>
<tr>
<td style="text-align:left;">
Pseudomonas viridiflava
</td>
<td style="text-align:left;">
species
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.63
</td>
<td style="text-align:left;">
Bacteria
</td>
<td style="text-align:left;">
Proteobacteria
</td>
<td style="text-align:left;">
Gammaproteobacteria
</td>
<td style="text-align:left;">
Pseudomonadales
</td>
<td style="text-align:left;">
Pseudomonadaceae
</td>
<td style="text-align:left;">
Pseudomonas
</td>
<td style="text-align:left;">
Pseudomonas viridiflava
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
k__Bacteria|p__Proteobacteria|c__Gammaproteobacteria|o__Pseudomonadales|f__Pseudomonadaceae|g__Pseudomonas|s__Pseudomonas viridiflava
</td>
</tr>
<tr>
<td style="text-align:left;">
Gardnerella
</td>
<td style="text-align:left;">
genus
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:left;">
Bacteria
</td>
<td style="text-align:left;">
Actinobacteria
</td>
<td style="text-align:left;">
Actinomycetia
</td>
<td style="text-align:left;">
Bifidobacteriales
</td>
<td style="text-align:left;">
Bifidobacteriaceae
</td>
<td style="text-align:left;">
Gardnerella
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
k__Bacteria|p__Actinobacteria|c__Actinomycetia|o__Bifidobacteriales|f__Bifidobacteriaceae|g__Gardnerella
</td>
</tr>
<tr>
<td style="text-align:left;">
Staphylococcaceae
</td>
<td style="text-align:left;">
family
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:left;">
Bacteria
</td>
<td style="text-align:left;">
Firmicutes
</td>
<td style="text-align:left;">
Bacilli
</td>
<td style="text-align:left;">
Bacillales
</td>
<td style="text-align:left;">
Staphylococcaceae
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
k__Bacteria|p__Firmicutes|c__Bacilli|o__Bacillales|f__Staphylococcaceae
</td>
</tr>
<tr>
<td style="text-align:left;">
Clostridium
</td>
<td style="text-align:left;">
genus
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:left;">
Bacteria
</td>
<td style="text-align:left;">
Firmicutes
</td>
<td style="text-align:left;">
Clostridia
</td>
<td style="text-align:left;">
Eubacteriales
</td>
<td style="text-align:left;">
Clostridiaceae
</td>
<td style="text-align:left;">
Clostridium
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
k__Bacteria|p__Firmicutes|c__Clostridia|o__Eubacteriales|f__Clostridiaceae|g__Clostridium
</td>
</tr>
<tr>
<td style="text-align:left;">
Faecalibacterium
</td>
<td style="text-align:left;">
genus
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:left;">
Bacteria
</td>
<td style="text-align:left;">
Firmicutes
</td>
<td style="text-align:left;">
Clostridia
</td>
<td style="text-align:left;">
Eubacteriales
</td>
<td style="text-align:left;">
Oscillospiraceae
</td>
<td style="text-align:left;">
Faecalibacterium
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
k__Bacteria|p__Firmicutes|c__Clostridia|o__Eubacteriales|f__Oscillospiraceae|g__Faecalibacterium
</td>
</tr>
<tr>
<td style="text-align:left;">
Campylobacter
</td>
<td style="text-align:left;">
genus
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:left;">
Bacteria
</td>
<td style="text-align:left;">
Proteobacteria
</td>
<td style="text-align:left;">
Epsilonproteobacteria
</td>
<td style="text-align:left;">
Campylobacterales
</td>
<td style="text-align:left;">
Campylobacteraceae
</td>
<td style="text-align:left;">
Campylobacter
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
k__Bacteria|p__Proteobacteria|c__Epsilonproteobacteria|o__Campylobacterales|f__Campylobacteraceae|g__Campylobacter
</td>
</tr>
<tr>
<td style="text-align:left;">
Micrococcaceae
</td>
<td style="text-align:left;">
family
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:left;">
Bacteria
</td>
<td style="text-align:left;">
Actinobacteria
</td>
<td style="text-align:left;">
Actinomycetia
</td>
<td style="text-align:left;">
Micrococcales
</td>
<td style="text-align:left;">
Micrococcaceae
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
k__Bacteria|p__Actinobacteria|c__Actinomycetia|o__Micrococcales|f__Micrococcaceae
</td>
</tr>
<tr>
<td style="text-align:left;">
Gemella
</td>
<td style="text-align:left;">
genus
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:left;">
Bacteria
</td>
<td style="text-align:left;">
Firmicutes
</td>
<td style="text-align:left;">
Bacilli
</td>
<td style="text-align:left;">
Bacillales
</td>
<td style="text-align:left;">
Gemella
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
k__Bacteria|p__Firmicutes|c__Bacilli|o__Bacillales|g__Gemella
</td>
</tr>
<tr>
<td style="text-align:left;">
Aerococcus
</td>
<td style="text-align:left;">
genus
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:left;">
Bacteria
</td>
<td style="text-align:left;">
Firmicutes
</td>
<td style="text-align:left;">
Bacilli
</td>
<td style="text-align:left;">
Lactobacillales
</td>
<td style="text-align:left;">
Aerococcaceae
</td>
<td style="text-align:left;">
Aerococcus
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
k__Bacteria|p__Firmicutes|c__Bacilli|o__Lactobacillales|f__Aerococcaceae|g__Aerococcus
</td>
</tr>
<tr>
<td style="text-align:left;">
Erysipelotrichaceae
</td>
<td style="text-align:left;">
family
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:left;">
Bacteria
</td>
<td style="text-align:left;">
Firmicutes
</td>
<td style="text-align:left;">
Erysipelotrichia
</td>
<td style="text-align:left;">
Erysipelotrichales
</td>
<td style="text-align:left;">
Erysipelotrichaceae
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
k__Bacteria|p__Firmicutes|c__Erysipelotrichia|o__Erysipelotrichales|f__Erysipelotrichaceae
</td>
</tr>
<tr>
<td style="text-align:left;">
Lactobacillus iners
</td>
<td style="text-align:left;">
species
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:left;">
Bacteria
</td>
<td style="text-align:left;">
Firmicutes
</td>
<td style="text-align:left;">
Bacilli
</td>
<td style="text-align:left;">
Lactobacillales
</td>
<td style="text-align:left;">
Lactobacillaceae
</td>
<td style="text-align:left;">
Lactobacillus
</td>
<td style="text-align:left;">
Lactobacillus iners
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
k__Bacteria|p__Firmicutes|c__Bacilli|o__Lactobacillales|f__Lactobacillaceae|g__Lactobacillus|s__Lactobacillus iners
</td>
</tr>
<tr>
<td style="text-align:left;">
Mobiluncus
</td>
<td style="text-align:left;">
genus
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:left;">
Bacteria
</td>
<td style="text-align:left;">
Actinobacteria
</td>
<td style="text-align:left;">
Actinomycetia
</td>
<td style="text-align:left;">
Actinomycetales
</td>
<td style="text-align:left;">
Actinomycetaceae
</td>
<td style="text-align:left;">
Mobiluncus
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
k__Bacteria|p__Actinobacteria|c__Actinomycetia|o__Actinomycetales|f__Actinomycetaceae|g__Mobiluncus
</td>
</tr>
<tr>
<td style="text-align:left;">
Prevotella
</td>
<td style="text-align:left;">
genus
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:left;">
Bacteria
</td>
<td style="text-align:left;">
Bacteroidetes
</td>
<td style="text-align:left;">
Bacteroidia
</td>
<td style="text-align:left;">
Bacteroidales
</td>
<td style="text-align:left;">
Prevotellaceae
</td>
<td style="text-align:left;">
Prevotella
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
k__Bacteria|p__Bacteroidetes|c__Bacteroidia|o__Bacteroidales|f__Prevotellaceae|g__Prevotella
</td>
</tr>
<tr>
<td style="text-align:left;">
Atopobium
</td>
<td style="text-align:left;">
genus
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.45
</td>
<td style="text-align:left;">
Bacteria
</td>
<td style="text-align:left;">
Actinobacteria
</td>
<td style="text-align:left;">
Coriobacteriia
</td>
<td style="text-align:left;">
Coriobacteriales
</td>
<td style="text-align:left;">
Atopobiaceae
</td>
<td style="text-align:left;">
Atopobium
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
k__Bacteria|p__Actinobacteria|c__Coriobacteriia|o__Coriobacteriales|f__Atopobiaceae|g__Atopobium
</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="load-hmp-data-from-curatedmetagenomicdata">Load HMP data from curatedMetagenomicData<a class="anchor" aria-label="anchor" href="#load-hmp-data-from-curatedmetagenomicdata"></a>
</h3>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/waldronlab/curatedMetagenomicData" class="external-link">curatedMetagenomicData</a></span><span class="op">)</span><span class="op">)</span>
<span class="co"># hmp_vagina_metadata &lt;- filter(sampleMetadata, study_name == "HMP_2012" &amp; body_site == "vagina")</span>
<span class="va">all_healthy_adult_vagina_metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sampleMetadata</span>, <span class="va">body_site</span> <span class="op">==</span> <span class="st">"vagina"</span> <span class="op">&amp;</span> <span class="va">disease</span> <span class="op">==</span> <span class="st">"healthy"</span> <span class="op">&amp;</span> <span class="va">age_category</span> <span class="op">==</span> <span class="st">"adult"</span><span class="op">)</span>
<span class="va">se</span> <span class="op">&lt;-</span>
  <span class="fu">curatedMetagenomicData</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/curatedMetagenomicData/man/returnSamples.html" class="external-link">returnSamples</a></span><span class="op">(</span><span class="va">all_healthy_adult_vagina_metadata</span>, dataType <span class="op">=</span> <span class="st">"relative_abundance"</span>, counts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>Get matrices of species and genus relative abundance</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">allranks</span> <span class="op">&lt;-</span> <span class="fu">mia</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mia/man/splitByRanks.html" class="external-link">splitByRanks</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span>
<span class="co">#species_relab &lt;- t(assay(allranks[["species"]]))</span>
<span class="va">genus_relab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">allranks</span><span class="op">[[</span><span class="st">"genus"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="co">#family_relab &lt;- t(assay(allranks[["family"]]))</span></code></pre></div>
<p>Centered log-ratio transformation on genus level relative abundance:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">genus_relab_clr</span> <span class="op">&lt;-</span> <span class="fu">Hotelling</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Hotelling/man/clr.html" class="external-link">clr</a></span><span class="op">(</span><span class="va">genus_relab</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">genus_relab_clr</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Streptococcus"</span>, <span class="st">"Lactobacillus"</span><span class="op">)</span><span class="op">)</span>
<span class="va">df</span><span class="op">$</span><span class="va">age</span> <span class="op">&lt;-</span> <span class="va">se</span><span class="op">$</span><span class="va">age</span>
<span class="va">df</span><span class="op">$</span><span class="va">BMI</span> <span class="op">&lt;-</span> <span class="va">se</span><span class="op">$</span><span class="va">BMI</span>
<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Streptococcus</span> <span class="op">~</span> <span class="va">Lactobacillus</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">BMI</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span>  
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## Call:</span>
<span class="co">## lm(formula = Streptococcus ~ Lactobacillus + age + BMI, data = df)</span>
<span class="co">## </span>
<span class="co">## Residuals:</span>
<span class="co">##     Min      1Q  Median      3Q     Max </span>
<span class="co">## -0.6728 -0.1875 -0.0264  0.0893  3.6729 </span>
<span class="co">## </span>
<span class="co">## Coefficients:</span>
<span class="co">##                Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">## (Intercept)   -0.386413   0.436694  -0.885 0.378987    </span>
<span class="co">## Lactobacillus -0.078095   0.047933  -1.629 0.107344    </span>
<span class="co">## age            0.035738   0.010073   3.548 0.000665 ***</span>
<span class="co">## BMI           -0.009094   0.014295  -0.636 0.526581    </span>
<span class="co">## ---</span>
<span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">## </span>
<span class="co">## Residual standard error: 0.4857 on 77 degrees of freedom</span>
<span class="co">##   (14 observations deleted due to missingness)</span>
<span class="co">## Multiple R-squared:  0.1799, Adjusted R-squared:  0.1479 </span>
<span class="co">## F-statistic: 5.629 on 3 and 77 DF,  p-value: 0.00153</span></code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Streptococcus</span> <span class="op">~</span> <span class="va">Lactobacillus</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## Call:</span>
<span class="co">## lm(formula = Streptococcus ~ Lactobacillus, data = df)</span>
<span class="co">## </span>
<span class="co">## Residuals:</span>
<span class="co">##     Min      1Q  Median      3Q     Max </span>
<span class="co">## -0.6006 -0.0609 -0.0462 -0.0440  4.1909 </span>
<span class="co">## </span>
<span class="co">## Coefficients:</span>
<span class="co">##               Estimate Std. Error t value Pr(&gt;|t|)   </span>
<span class="co">## (Intercept)    0.55246    0.20193   2.736  0.00745 **</span>
<span class="co">## Lactobacillus -0.11409    0.04751  -2.401  0.01832 * </span>
<span class="co">## ---</span>
<span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">## </span>
<span class="co">## Residual standard error: 0.5642 on 93 degrees of freedom</span>
<span class="co">## Multiple R-squared:  0.05839,    Adjusted R-squared:  0.04826 </span>
<span class="co">## F-statistic: 5.767 on 1 and 93 DF,  p-value: 0.01832</span></code></pre>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">wilcox.test</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Streptococcus</span>, <span class="va">df</span><span class="op">$</span><span class="va">Lactobacillus</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">##  Wilcoxon rank sum test with continuity correction</span>
<span class="co">## </span>
<span class="co">## data:  df$Streptococcus and df$Lactobacillus</span>
<span class="co">## W = 213.5, p-value &lt; 2.2e-16</span>
<span class="co">## alternative hypothesis: true location shift is not equal to 0</span></code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Streptococcus</span>, <span class="va">df</span><span class="op">$</span><span class="va">Lactobacillus</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">##  Welch Two Sample t-test</span>
<span class="co">## </span>
<span class="co">## data:  df$Streptococcus and df$Lactobacillus</span>
<span class="co">## t = -28.666, df = 133.93, p-value &lt; 2.2e-16</span>
<span class="co">## alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co">## 95 percent confidence interval:</span>
<span class="co">##  -4.258800 -3.709054</span>
<span class="co">## sample estimates:</span>
<span class="co">## mean of x mean of y </span>
<span class="co">## 0.0879008 4.0718280</span></code></pre>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">secount</span> <span class="op">&lt;-</span>
  <span class="fu">curatedMetagenomicData</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/curatedMetagenomicData/man/returnSamples.html" class="external-link">returnSamples</a></span><span class="op">(</span><span class="va">all_healthy_adult_vagina_metadata</span>, dataType <span class="op">=</span> <span class="st">"relative_abundance"</span>, counts <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## snapshotDate(): 2021-10-19</span></code></pre>
<pre><code><span class="co">## </span>
<span class="co">## $`2021-03-31.FerrettiP_2018.relative_abundance`</span>
<span class="co">## dropping rows without rowTree matches:</span>
<span class="co">##   k__Bacteria|p__Actinobacteria|c__Coriobacteriia|o__Coriobacteriales|f__Coriobacteriaceae|g__Collinsella|s__Collinsella_stercoris</span>
<span class="co">##   k__Bacteria|p__Actinobacteria|c__Coriobacteriia|o__Coriobacteriales|f__Coriobacteriaceae|g__Enorma|s__[Collinsella]_massiliensis</span>
<span class="co">##   k__Bacteria|p__Firmicutes|c__Bacilli|o__Bacillales|f__Bacillales_unclassified|g__Gemella|s__Gemella_bergeri</span>
<span class="co">##   k__Bacteria|p__Firmicutes|c__Bacilli|o__Lactobacillales|f__Carnobacteriaceae|g__Granulicatella|s__Granulicatella_elegans</span>
<span class="co">##   k__Bacteria|p__Firmicutes|c__Clostridia|o__Clostridiales|f__Ruminococcaceae|g__Ruminococcus|s__Ruminococcus_champanellensis</span>
<span class="co">##   k__Bacteria|p__Firmicutes|c__Erysipelotrichia|o__Erysipelotrichales|f__Erysipelotrichaceae|g__Bulleidia|s__Bulleidia_extructa</span>
<span class="co">##   k__Bacteria|p__Proteobacteria|c__Betaproteobacteria|o__Burkholderiales|f__Sutterellaceae|g__Sutterella|s__Sutterella_parvirubra</span>
<span class="co">##   k__Bacteria|p__Spirochaetes|c__Spirochaetia|o__Leptospirales|f__Leptospiraceae|g__Leptospira|s__Leptospira_hartskeerlii</span>
<span class="co">##   k__Bacteria|p__Synergistetes|c__Synergistia|o__Synergistales|f__Synergistaceae|g__Cloacibacillus|s__Cloacibacillus_evryensis</span></code></pre>
<pre><code><span class="co">## $`2021-03-31.HMP_2012.relative_abundance`</span>
<span class="co">## dropping rows without rowTree matches:</span>
<span class="co">##   k__Bacteria|p__Actinobacteria|c__Coriobacteriia|o__Coriobacteriales|f__Atopobiaceae|g__Olsenella|s__Olsenella_profusa</span>
<span class="co">##   k__Bacteria|p__Actinobacteria|c__Coriobacteriia|o__Coriobacteriales|f__Coriobacteriaceae|g__Collinsella|s__Collinsella_stercoris</span>
<span class="co">##   k__Bacteria|p__Actinobacteria|c__Coriobacteriia|o__Coriobacteriales|f__Coriobacteriaceae|g__Enorma|s__[Collinsella]_massiliensis</span>
<span class="co">##   k__Bacteria|p__Firmicutes|c__Bacilli|o__Bacillales|f__Bacillales_unclassified|g__Gemella|s__Gemella_bergeri</span>
<span class="co">##   k__Bacteria|p__Firmicutes|c__Bacilli|o__Lactobacillales|f__Carnobacteriaceae|g__Granulicatella|s__Granulicatella_elegans</span>
<span class="co">##   k__Bacteria|p__Firmicutes|c__Clostridia|o__Clostridiales|f__Ruminococcaceae|g__Ruminococcus|s__Ruminococcus_champanellensis</span>
<span class="co">##   k__Bacteria|p__Firmicutes|c__Erysipelotrichia|o__Erysipelotrichales|f__Erysipelotrichaceae|g__Bulleidia|s__Bulleidia_extructa</span>
<span class="co">##   k__Bacteria|p__Proteobacteria|c__Betaproteobacteria|o__Burkholderiales|f__Sutterellaceae|g__Sutterella|s__Sutterella_parvirubra</span>
<span class="co">##   k__Bacteria|p__Synergistetes|c__Synergistia|o__Synergistales|f__Synergistaceae|g__Cloacibacillus|s__Cloacibacillus_evryensis</span></code></pre>
<pre><code><span class="co">## $`2021-03-31.WampachL_2018.relative_abundance`</span>
<span class="co">## dropping rows without rowTree matches:</span>
<span class="co">##   k__Bacteria|p__Actinobacteria|c__Coriobacteriia|o__Coriobacteriales|f__Coriobacteriaceae|g__Collinsella|s__Collinsella_stercoris</span>
<span class="co">##   k__Bacteria|p__Actinobacteria|c__Coriobacteriia|o__Coriobacteriales|f__Coriobacteriaceae|g__Enorma|s__[Collinsella]_massiliensis</span>
<span class="co">##   k__Bacteria|p__Firmicutes|c__Bacilli|o__Lactobacillales|f__Carnobacteriaceae|g__Granulicatella|s__Granulicatella_elegans</span>
<span class="co">##   k__Bacteria|p__Proteobacteria|c__Betaproteobacteria|o__Burkholderiales|f__Sutterellaceae|g__Sutterella|s__Sutterella_parvirubra</span>
<span class="co">##   k__Bacteria|p__Synergistetes|c__Synergistia|o__Synergistales|f__Synergistaceae|g__Cloacibacillus|s__Cloacibacillus_evryensis</span></code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">allranks</span> <span class="op">&lt;-</span> <span class="fu">mia</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mia/man/splitByRanks.html" class="external-link">splitByRanks</a></span><span class="op">(</span><span class="va">secount</span><span class="op">)</span>
<span class="va">genus_relab_count</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">allranks</span><span class="op">[[</span><span class="st">"genus"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">genus_relab_count</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Streptococcus"</span>, <span class="st">"Lactobacillus"</span><span class="op">)</span><span class="op">)</span>
<span class="va">df</span><span class="op">$</span><span class="va">age</span> <span class="op">&lt;-</span> <span class="va">secount</span><span class="op">$</span><span class="va">age</span>
<span class="va">df</span><span class="op">$</span><span class="va">BMI</span> <span class="op">&lt;-</span> <span class="va">secount</span><span class="op">$</span><span class="va">BMI</span></code></pre></div>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://github.com/atahk/pscl" class="external-link">pscl</a></span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Classes and Methods for R developed in the</span>
<span class="co">## Political Science Computational Laboratory</span>
<span class="co">## Department of Political Science</span>
<span class="co">## Stanford University</span>
<span class="co">## Simon Jackman</span>
<span class="co">## hurdle and zeroinfl functions by Achim Zeileis</span></code></pre>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit.ZInegbin</span> <span class="op">&lt;-</span> <span class="fu">pscl</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pscl/man/zeroinfl.html" class="external-link">zeroinfl</a></span><span class="op">(</span><span class="va">Streptococcus</span> <span class="op">~</span> <span class="va">Lactobacillus</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">BMI</span> <span class="op">|</span> <span class="fl">1</span>,
                data <span class="op">=</span> <span class="va">df</span>,
                dist <span class="op">=</span> <span class="st">"negbin"</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="create-a-data-frame-for-regression-analysis-from-healthy-controls-for-log-linear-model">Create a data frame for regression analysis from healthy controls for log-linear model<a class="anchor" aria-label="anchor" href="#create-a-data-frame-for-regression-analysis-from-healthy-controls-for-log-linear-model"></a>
</h2>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/waldronlab/curatedMetagenomicData" class="external-link">curatedMetagenomicData</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/DT" class="external-link">DT</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://purrr.tidyverse.org" class="external-link">purrr</a></span><span class="op">)</span>

<span class="va">taxon_strep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1884"</span> <span class="op">=</span> <span class="st">"Streptococcus"</span><span class="op">)</span>
<span class="va">taxon_lact</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1578"</span> <span class="op">=</span> <span class="st">"Lactobacillus"</span><span class="op">)</span>

<span class="va">target_sample</span> <span class="op">&lt;-</span> <span class="st">"vagina"</span>
<span class="va">sample_metadata</span> <span class="op">&lt;-</span> <span class="va">sampleMetadata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span>
        <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="va">target_sample</span>, <span class="va">body_site</span><span class="op">)</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="va">target_sample</span>, <span class="va">body_subsite</span><span class="op">)</span>
    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">sample_metadata</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 96 26</span></code></pre>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">sample_metadata</span><span class="op">$</span><span class="va">study_name</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "FerrettiP_2018" "HMP_2012"       "WampachL_2018"</span></code></pre>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/curatedMetagenomicData/man/returnSamples.html" class="external-link">returnSamples</a></span><span class="op">(</span>
    sampleMetadata <span class="op">=</span> <span class="va">sample_metadata</span>,
    dataType <span class="op">=</span> <span class="st">"relative_abundance"</span>,
    counts <span class="op">=</span> <span class="cn">FALSE</span>,
    rownames <span class="op">=</span> <span class="st">"short"</span>
<span class="op">)</span></code></pre></div>
<pre><code><span class="co">## snapshotDate(): 2021-10-19</span></code></pre>
<pre><code><span class="co">## </span>
<span class="co">## $`2021-03-31.FerrettiP_2018.relative_abundance`</span>
<span class="co">## dropping rows without rowTree matches:</span>
<span class="co">##   k__Bacteria|p__Actinobacteria|c__Coriobacteriia|o__Coriobacteriales|f__Coriobacteriaceae|g__Collinsella|s__Collinsella_stercoris</span>
<span class="co">##   k__Bacteria|p__Actinobacteria|c__Coriobacteriia|o__Coriobacteriales|f__Coriobacteriaceae|g__Enorma|s__[Collinsella]_massiliensis</span>
<span class="co">##   k__Bacteria|p__Firmicutes|c__Bacilli|o__Bacillales|f__Bacillales_unclassified|g__Gemella|s__Gemella_bergeri</span>
<span class="co">##   k__Bacteria|p__Firmicutes|c__Bacilli|o__Lactobacillales|f__Carnobacteriaceae|g__Granulicatella|s__Granulicatella_elegans</span>
<span class="co">##   k__Bacteria|p__Firmicutes|c__Clostridia|o__Clostridiales|f__Ruminococcaceae|g__Ruminococcus|s__Ruminococcus_champanellensis</span>
<span class="co">##   k__Bacteria|p__Firmicutes|c__Erysipelotrichia|o__Erysipelotrichales|f__Erysipelotrichaceae|g__Bulleidia|s__Bulleidia_extructa</span>
<span class="co">##   k__Bacteria|p__Proteobacteria|c__Betaproteobacteria|o__Burkholderiales|f__Sutterellaceae|g__Sutterella|s__Sutterella_parvirubra</span>
<span class="co">##   k__Bacteria|p__Spirochaetes|c__Spirochaetia|o__Leptospirales|f__Leptospiraceae|g__Leptospira|s__Leptospira_hartskeerlii</span>
<span class="co">##   k__Bacteria|p__Synergistetes|c__Synergistia|o__Synergistales|f__Synergistaceae|g__Cloacibacillus|s__Cloacibacillus_evryensis</span></code></pre>
<pre><code><span class="co">## $`2021-03-31.HMP_2012.relative_abundance`</span>
<span class="co">## dropping rows without rowTree matches:</span>
<span class="co">##   k__Bacteria|p__Actinobacteria|c__Coriobacteriia|o__Coriobacteriales|f__Atopobiaceae|g__Olsenella|s__Olsenella_profusa</span>
<span class="co">##   k__Bacteria|p__Actinobacteria|c__Coriobacteriia|o__Coriobacteriales|f__Coriobacteriaceae|g__Collinsella|s__Collinsella_stercoris</span>
<span class="co">##   k__Bacteria|p__Actinobacteria|c__Coriobacteriia|o__Coriobacteriales|f__Coriobacteriaceae|g__Enorma|s__[Collinsella]_massiliensis</span>
<span class="co">##   k__Bacteria|p__Firmicutes|c__Bacilli|o__Bacillales|f__Bacillales_unclassified|g__Gemella|s__Gemella_bergeri</span>
<span class="co">##   k__Bacteria|p__Firmicutes|c__Bacilli|o__Lactobacillales|f__Carnobacteriaceae|g__Granulicatella|s__Granulicatella_elegans</span>
<span class="co">##   k__Bacteria|p__Firmicutes|c__Clostridia|o__Clostridiales|f__Ruminococcaceae|g__Ruminococcus|s__Ruminococcus_champanellensis</span>
<span class="co">##   k__Bacteria|p__Firmicutes|c__Erysipelotrichia|o__Erysipelotrichales|f__Erysipelotrichaceae|g__Bulleidia|s__Bulleidia_extructa</span>
<span class="co">##   k__Bacteria|p__Proteobacteria|c__Betaproteobacteria|o__Burkholderiales|f__Sutterellaceae|g__Sutterella|s__Sutterella_parvirubra</span>
<span class="co">##   k__Bacteria|p__Synergistetes|c__Synergistia|o__Synergistales|f__Synergistaceae|g__Cloacibacillus|s__Cloacibacillus_evryensis</span></code></pre>
<pre><code><span class="co">## $`2021-03-31.WampachL_2018.relative_abundance`</span>
<span class="co">## dropping rows without rowTree matches:</span>
<span class="co">##   k__Bacteria|p__Actinobacteria|c__Coriobacteriia|o__Coriobacteriales|f__Coriobacteriaceae|g__Collinsella|s__Collinsella_stercoris</span>
<span class="co">##   k__Bacteria|p__Actinobacteria|c__Coriobacteriia|o__Coriobacteriales|f__Coriobacteriaceae|g__Enorma|s__[Collinsella]_massiliensis</span>
<span class="co">##   k__Bacteria|p__Firmicutes|c__Bacilli|o__Lactobacillales|f__Carnobacteriaceae|g__Granulicatella|s__Granulicatella_elegans</span>
<span class="co">##   k__Bacteria|p__Proteobacteria|c__Betaproteobacteria|o__Burkholderiales|f__Sutterellaceae|g__Sutterella|s__Sutterella_parvirubra</span>
<span class="co">##   k__Bacteria|p__Synergistetes|c__Synergistia|o__Synergistales|f__Synergistaceae|g__Cloacibacillus|s__Cloacibacillus_evryensis</span></code></pre>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tse</span></code></pre></div>
<pre><code><span class="co">## class: TreeSummarizedExperiment </span>
<span class="co">## dim: 902 96 </span>
<span class="co">## metadata(0):</span>
<span class="co">## assays(1): relative_abundance</span>
<span class="co">## rownames(902): Escherichia coli Klebsiella michiganensis ...</span>
<span class="co">##   Pediococcus pentosaceus Rahnella aquatilis</span>
<span class="co">## rowData names(7): superkingdom phylum ... genus species</span>
<span class="co">## colnames(96): CA_C10001MS2003VA_t0M15 CA_C10003MS2031VA_t0M15 ...</span>
<span class="co">##   MV_C118 MV_C120</span>
<span class="co">## colData names(25): study_name subject_id ... family_role body_subsite</span>
<span class="co">## reducedDimNames(0):</span>
<span class="co">## mainExpName: NULL</span>
<span class="co">## altExpNames(0):</span>
<span class="co">## rowLinks: a LinkDataFrame (902 rows)</span>
<span class="co">## rowTree: 1 phylo tree(s) (10430 leaves)</span>
<span class="co">## colLinks: NULL</span>
<span class="co">## colTree: NULL</span></code></pre>
<div class="section level3">
<h3 id="comparing-mean-to-variance-of-the-outcome-variable">Comparing mean to variance of the outcome variable<a class="anchor" aria-label="anchor" href="#comparing-mean-to-variance-of-the-outcome-variable"></a>
</h3>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Streptococcus</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 4049.558</span></code></pre>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Streptococcus</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 509068831</span></code></pre>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fraczeroes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">Streptococcus</span> <span class="op">==</span> <span class="fl">0</span>,<span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>
<span class="va">fraczeroes</span></code></pre></div>
<pre><code><span class="co">## [1] 0.8736842</span></code></pre>
<p>#Fit log-linear models</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit.pois</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Streptococcus</span> <span class="op">~</span> <span class="va">Lactobacillus</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">BMI</span>,
                data <span class="op">=</span> <span class="va">df</span>,
                family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span> <span class="op">(</span><span class="va">fit.pois</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## Call:</span>
<span class="co">## glm(formula = Streptococcus ~ Lactobacillus + age + BMI, family = poisson(link = "log"), </span>
<span class="co">##     data = df)</span>
<span class="co">## </span>
<span class="co">## Deviance Residuals: </span>
<span class="co">##     Min       1Q   Median       3Q      Max  </span>
<span class="co">## -206.14   -36.50   -19.90   -10.99   541.19  </span>
<span class="co">## </span>
<span class="co">## Coefficients:</span>
<span class="co">##                 Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="co">## (Intercept)   -5.313e-01  1.873e-02  -28.36   &lt;2e-16 ***</span>
<span class="co">## Lactobacillus  5.141e-08  9.828e-10   52.32   &lt;2e-16 ***</span>
<span class="co">## age            3.599e-01  4.136e-04  870.25   &lt;2e-16 ***</span>
<span class="co">## BMI           -1.573e-01  6.453e-04 -243.77   &lt;2e-16 ***</span>
<span class="co">## ---</span>
<span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">## </span>
<span class="co">## (Dispersion parameter for poisson family taken to be 1)</span>
<span class="co">## </span>
<span class="co">##     Null deviance: 1929049  on 80  degrees of freedom</span>
<span class="co">## Residual deviance:  632598  on 77  degrees of freedom</span>
<span class="co">##   (14 observations deleted due to missingness)</span>
<span class="co">## AIC: 632704</span>
<span class="co">## </span>
<span class="co">## Number of Fisher Scoring iterations: 20</span></code></pre>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://github.com/atahk/pscl" class="external-link">pscl</a></span><span class="op">)</span>
<span class="va">fit.ZIpois</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pscl/man/zeroinfl.html" class="external-link">zeroinfl</a></span><span class="op">(</span><span class="va">Streptococcus</span> <span class="op">~</span> <span class="va">Lactobacillus</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">BMI</span> <span class="op">|</span> <span class="fl">1</span>,
                data <span class="op">=</span> <span class="va">df</span>,
                dist <span class="op">=</span> <span class="st">"poisson"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span> <span class="op">(</span><span class="va">fit.ZIpois</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## Call:</span>
<span class="co">## zeroinfl(formula = Streptococcus ~ Lactobacillus + age + BMI | 1, data = df, </span>
<span class="co">##     dist = "poisson")</span>
<span class="co">## </span>
<span class="co">## Pearson residuals:</span>
<span class="co">##     Min      1Q  Median      3Q     Max </span>
<span class="co">## -0.3753 -0.3753 -0.3752 -0.3750 27.8168 </span>
<span class="co">## </span>
<span class="co">## Count model coefficients (poisson with log link):</span>
<span class="co">##                 Estimate Std. Error z value Pr(&gt;|z|)</span>
<span class="co">## (Intercept)    6.169e+00        NaN     NaN      NaN</span>
<span class="co">## Lactobacillus  1.321e-07        NaN     NaN      NaN</span>
<span class="co">## age            2.420e-01        NaN     NaN      NaN</span>
<span class="co">## BMI           -2.116e-01        NaN     NaN      NaN</span>
<span class="co">## </span>
<span class="co">## Zero-inflation model coefficients (binomial with logit link):</span>
<span class="co">##             Estimate Std. Error z value Pr(&gt;|z|)</span>
<span class="co">## (Intercept)     1.96        NaN     NaN      NaN</span>
<span class="co">## </span>
<span class="co">## Number of iterations in BFGS optimization: 1 </span>
<span class="co">## Log-likelihood: -1.02e+05 on 5 Df</span></code></pre>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## Attaching package: 'MASS'</span></code></pre>
<pre><code><span class="co">## The following object is masked from 'package:dplyr':</span>
<span class="co">## </span>
<span class="co">##     select</span></code></pre>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit.negbin</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/glm.nb.html" class="external-link">glm.nb</a></span><span class="op">(</span>
    <span class="va">Streptococcus</span> <span class="op">~</span> <span class="va">Lactobacillus</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">BMI</span>,
    data <span class="op">=</span> <span class="va">df</span>,
    control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.control.html" class="external-link">glm.control</a></span><span class="op">(</span>
      epsilon <span class="op">=</span> <span class="fl">1e-8</span>,
      maxit <span class="op">=</span> <span class="fl">25</span>,
      trace <span class="op">=</span> <span class="cn">FALSE</span>
    <span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: glm.fit: algorithm did not converge</span>

<span class="co">## Warning: glm.fit: algorithm did not converge</span>

<span class="co">## Warning: glm.fit: algorithm did not converge</span></code></pre>
<pre><code><span class="co">## Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =</span>
<span class="co">## control$trace &gt; : iteration limit reached</span></code></pre>
<pre><code><span class="co">## Warning in sqrt(1/i): NaNs produced</span></code></pre>
<pre><code><span class="co">## Warning: glm.fit: algorithm did not converge</span></code></pre>
<pre><code><span class="co">## Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =</span>
<span class="co">## control$trace &gt; : iteration limit reached</span></code></pre>
<pre><code><span class="co">## Warning in sqrt(1/i): NaNs produced</span></code></pre>
<pre><code><span class="co">## Warning: glm.fit: algorithm did not converge</span>

<span class="co">## Warning: glm.fit: algorithm did not converge</span>

<span class="co">## Warning: glm.fit: algorithm did not converge</span></code></pre>
<pre><code><span class="co">## Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =</span>
<span class="co">## control$trace &gt; : iteration limit reached</span></code></pre>
<pre><code><span class="co">## Warning in sqrt(1/i): NaNs produced</span></code></pre>
<pre><code><span class="co">## Warning: glm.fit: algorithm did not converge</span></code></pre>
<pre><code><span class="co">## Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =</span>
<span class="co">## control$trace &gt; : iteration limit reached</span></code></pre>
<pre><code><span class="co">## Warning in sqrt(1/i): NaNs produced</span></code></pre>
<pre><code><span class="co">## Warning: glm.fit: algorithm did not converge</span>

<span class="co">## Warning: glm.fit: algorithm did not converge</span>

<span class="co">## Warning: glm.fit: algorithm did not converge</span></code></pre>
<pre><code><span class="co">## Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =</span>
<span class="co">## control$trace &gt; : iteration limit reached</span></code></pre>
<pre><code><span class="co">## Warning in sqrt(1/i): NaNs produced</span></code></pre>
<pre><code><span class="co">## Warning: glm.fit: algorithm did not converge</span></code></pre>
<pre><code><span class="co">## Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =</span>
<span class="co">## control$trace &gt; : iteration limit reached</span></code></pre>
<pre><code><span class="co">## Warning in sqrt(1/i): NaNs produced</span></code></pre>
<pre><code><span class="co">## Warning: glm.fit: algorithm did not converge</span>

<span class="co">## Warning: glm.fit: algorithm did not converge</span>

<span class="co">## Warning: glm.fit: algorithm did not converge</span></code></pre>
<pre><code><span class="co">## Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =</span>
<span class="co">## control$trace &gt; : iteration limit reached</span></code></pre>
<pre><code><span class="co">## Warning in sqrt(1/i): NaNs produced</span></code></pre>
<pre><code><span class="co">## Warning: glm.fit: algorithm did not converge</span></code></pre>
<pre><code><span class="co">## Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =</span>
<span class="co">## control$trace &gt; : iteration limit reached</span></code></pre>
<pre><code><span class="co">## Warning in sqrt(1/i): NaNs produced</span></code></pre>
<pre><code><span class="co">## Warning: glm.fit: algorithm did not converge</span>

<span class="co">## Warning: glm.fit: algorithm did not converge</span>

<span class="co">## Warning: glm.fit: algorithm did not converge</span></code></pre>
<pre><code><span class="co">## Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =</span>
<span class="co">## control$trace &gt; : iteration limit reached</span></code></pre>
<pre><code><span class="co">## Warning in sqrt(1/i): NaNs produced</span></code></pre>
<pre><code><span class="co">## Warning: glm.fit: algorithm did not converge</span></code></pre>
<pre><code><span class="co">## Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =</span>
<span class="co">## control$trace &gt; : iteration limit reached</span></code></pre>
<pre><code><span class="co">## Warning in sqrt(1/i): NaNs produced</span></code></pre>
<pre><code><span class="co">## Warning in glm.nb(Streptococcus ~ Lactobacillus + age + BMI, data = df, :</span>
<span class="co">## alternation limit reached</span></code></pre>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit.negbin</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## Call:</span>
<span class="co">## glm.nb(formula = Streptococcus ~ Lactobacillus + age + BMI, data = df, </span>
<span class="co">##     control = glm.control(epsilon = 1e-08, maxit = 25, trace = FALSE), </span>
<span class="co">##     init.theta = 0.01199558153, link = log)</span>
<span class="co">## </span>
<span class="co">## Deviance Residuals: </span>
<span class="co">##    Min      1Q  Median      3Q     Max  </span>
<span class="co">## -206.1   -36.5   -19.9   -11.0   541.2  </span>
<span class="co">## </span>
<span class="co">## Coefficients:</span>
<span class="co">##                 Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="co">## (Intercept)   -5.313e-01  1.873e-02  -28.36   &lt;2e-16 ***</span>
<span class="co">## Lactobacillus  5.141e-08  9.828e-10   52.32   &lt;2e-16 ***</span>
<span class="co">## age            3.599e-01  4.136e-04  870.25   &lt;2e-16 ***</span>
<span class="co">## BMI           -1.573e-01  6.453e-04 -243.77   &lt;2e-16 ***</span>
<span class="co">## ---</span>
<span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">## </span>
<span class="co">## (Dispersion parameter for Negative Binomial(5.380153e+14) family taken to be 1)</span>
<span class="co">## </span>
<span class="co">##     Null deviance: 1929048  on 80  degrees of freedom</span>
<span class="co">## Residual deviance:  632598  on 77  degrees of freedom</span>
<span class="co">##   (14 observations deleted due to missingness)</span>
<span class="co">## AIC: 280.39</span>
<span class="co">## </span>
<span class="co">## Number of Fisher Scoring iterations: 5</span>
<span class="co">## </span>
<span class="co">## </span>
<span class="co">##               Theta:  0.01200 </span>
<span class="co">##           Std. Err.:  0.00395 </span>
<span class="co">## Warning while fitting theta: alternation limit reached </span>
<span class="co">## </span>
<span class="co">##  2 x log-likelihood:  -270.38700</span></code></pre>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit.ZInegbin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pscl/man/zeroinfl.html" class="external-link">zeroinfl</a></span><span class="op">(</span><span class="va">Streptococcus</span> <span class="op">~</span> <span class="va">Lactobacillus</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">BMI</span> <span class="op">|</span> <span class="fl">1</span>,
                data <span class="op">=</span> <span class="va">df</span>,
                dist <span class="op">=</span> <span class="st">"negbin"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit.ZInegbin</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## Call:</span>
<span class="co">## zeroinfl(formula = Streptococcus ~ Lactobacillus + age + BMI | 1, data = df, </span>
<span class="co">##     dist = "negbin")</span>
<span class="co">## </span>
<span class="co">## Pearson residuals:</span>
<span class="co">##     Min      1Q  Median      3Q     Max </span>
<span class="co">## -0.1898 -0.1898 -0.1898 -0.1898  7.0566 </span>
<span class="co">## </span>
<span class="co">## Count model coefficients (negbin with log link):</span>
<span class="co">##                 Estimate Std. Error z value Pr(&gt;|z|)</span>
<span class="co">## (Intercept)    1.945e+01        NaN     NaN      NaN</span>
<span class="co">## Lactobacillus -2.787e-07        NaN     NaN      NaN</span>
<span class="co">## age            2.837e-02        NaN     NaN      NaN</span>
<span class="co">## BMI           -4.085e-01        NaN     NaN      NaN</span>
<span class="co">## Log(theta)    -9.837e-01        NaN     NaN      NaN</span>
<span class="co">## </span>
<span class="co">## Zero-inflation model coefficients (binomial with logit link):</span>
<span class="co">##             Estimate Std. Error z value Pr(&gt;|z|)</span>
<span class="co">## (Intercept)    1.921        NaN     NaN      NaN</span>
<span class="co">## </span>
<span class="co">## Theta = 0.3739 </span>
<span class="co">## Number of iterations in BFGS optimization: 14 </span>
<span class="co">## Log-likelihood: -131.8 on 6 Df</span></code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Ludwig Geistlinger, Chloe Mirzayi, Fatima Zohra, Levi Waldron.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
